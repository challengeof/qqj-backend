<loader class="maskLayer"></loader>
<div class="container-fluid">
    <!-- 页面标题 -->
    <div class="row">
        <div class="col-lg-12">
            <h2 class="page-header">我的客户</h2>
        </div>
    </div>

    <!-- 搜索条件表单 -->
    <div class="row">
        <div class="col-lg-12">
            <form rol="form" class="form-inline">
                <div class="form-group">
                    <select refresh-enabled="Integer" class="form-control" ng-model="restaurantSearchForm.cityId" ng-options="city.id as city.name for city in cities">
                        <option value="">请选择-城市</option>
                    </select>
                </div>
                <div class="form-group">
                    <select refresh-enabled="Integer" class="form-control" ng-model="restaurantSearchForm.warehouseId" ng-options="o.id as o.name for o in availableWarehouses">
                        <option value="">请选择-市场</option>
                    </select>
                </div>
                <div class="form-group">
                    <input refresh-enabled="String" type="text" class="form-control" placeholder="店名" ng-model="restaurantSearchForm.name">
                </div>
                <div class="form-group">
                    <input refresh-enabled="String" type="text" class="form-control" placeholder="联系电话" ng-model="restaurantSearchForm.telephone">
                </div>
                <div class="form-group">
                    <input refresh-enabled="Date" type="text" class="form-control" placeholder="起始时间" datepicker-popup="{{format}}" ng-model="startDate" is-open="openedStart" datepicker-options="dateOptions" current-text="今日" clear-text="清除" close-text="关闭" ng-click="openStart($event)"/>
                </div>
                <div class="form-group">
                    <input refresh-enabled="Date" type="text" class="form-control" placeholder="结束时间" datepicker-popup="{{format}}" ng-model="endDate" is-open="openedEnd" datepicker-options="dateOptions" current-text="今日" clear-text="清除" close-text="关闭" ng-click="openEnd($event)"/>
                </div>
                <div class="form-group">
                    <input refresh-enabled="Integer" type="text" class="form-control" placeholder="餐馆ID" ng-model="restaurantSearchForm.id"/>
                </div>
                <div class="form-group">
                    <input refresh-enabled="String" type="text" class="form-control" placeholder="注册电话" ng-model="restaurantSearchForm.registPhone"/>
                </div>
                <!--<div class="form-group">-->
                    <!--<input type="text" class="form-control" placeholder="未下单天数" ng-model="restaurantSearchForm.blankTime"/>-->
                <!--</div>-->
                <div class="form-group form-inline-with-uiselect-min">
                    <span class="nullable">
                        <refresh-enabled ng-model="restaurantSearchForm.adminUserId" >
                            <ui-select ng-model="restaurantSearchForm.adminUserId" theme="bootstrap" reset-search-input="true">
                                <ui-select-match allow-clear placeholder="请选择-销售">
                                    {{$select.selected.realname}}
                                </ui-select-match>
                                <ui-select-choices repeat="adminUser.id as adminUser in adminUsers | filter: $select.search" refresh-delay="0">
                                    <span ng-bind-html="adminUser.realname | highlight: $select.search"></span>
                                </ui-select-choices>
                            </ui-select>
                        </refresh-enabled>
                    </span>
                </div>
                <div class="form-group">
                    <span class="nullable">
                        <select refresh-enabled="Integer" class="form-control" ng-model="restaurantSearchForm.status" ng-options="o.value as o.name for o in availableStatus">
                            <option value="">请选择-餐馆状态</option>
                        </select>
                    </span>
                </div>
                <div class="form-group">
                    <select refresh-enabled="Integer" class="form-control" ng-model="restaurantSearchForm.restaurantActiveType" ng-options="activeType.val as activeType.detail for activeType in restaurantActiveType">
                        <option value="">请选择-客户类型</option>
                    </select>
                </div>
                <!--<div class="form-group">-->
                    <!--<select class="form-control" ng-model="restaurantSearchForm.grade" ng-options="grade.grade as grade.desc for grade in grades">-->
                        <!--<option value="">请选择-客户等级</option>-->
                    <!--</select>-->
                <!--</div>-->
                <!--<div class="form-group">-->
                    <!--<select class="form-control" ng-model="restaurantSearchForm.warning" ng-options="warning.key as warning.value for warning in warnings">-->
                        <!--<option value="">请选择-预警状态</option>-->
                    <!--</select>-->
                <!--</div>-->

                <!--<div class="form-group form-inline-with-uiselect-min">-->
                    <!--<span class="nullable">-->
                        <!--<ui-select  refresh-enabled="Integer" ng-model="searchForm.blockId" theme="bootstrap" reset-search-input="true">-->
                            <!--<ui-select-match allow-clear placeholder="请选择-区块">-->
                                <!--{{$select.selected.displayName}}-->
                            <!--</ui-select-match>-->
                            <!--<ui-select-choices repeat="block.id as block in blocks | filter: $select.search" refresh-delay="0">-->
                                <!--<span ng-bind-html="block.displayName | highlight: $select.search"></span>-->
                            <!--</ui-select-choices>-->
                        <!--</ui-select>-->
                    <!--</span>-->
                <!--</div>-->

                <!--<div class="form-group">-->
                    <!--<input type="checkbox" ng-model="restaurantSearchForm.neverOrder"/>注册未下单-->
                <!--</div>-->
                <div class="form-group">


                    <button type="submit" class="btn btn-primary" ng-click="resetPageAndSearchRestaurant()">&nbsp;&nbsp;搜&nbsp;&nbsp;索&nbsp;&nbsp;</button>

                    <button type="button" ui-sref="crm.customerDetail({ type:'add',addType:'myAdd' })" class="btn btn-primary" >&nbsp;&nbsp;添&nbsp;&nbsp;加&nbsp;&nbsp;</button>
                    <button type="button" class="btn btn-primary" ng-click="export()">&nbsp;&nbsp;导&nbsp;&nbsp;出&nbsp;&nbsp;</button>
                </div>
            </form>
        </div>
    </div>
    <br>

    <!--&lt;!&ndash; 商户管理 餐馆列表 &ndasht;;&g-->
    <!--<div class="row">-->
        <!--<div class="col-lg-12 dataTable_wrapper table-responsive">-->
            <!--<div class="panel panel-default">-->
                <!--<div class="panel-heading">-->
                    <!--<strong>-->
                        <!--共计商户数：<span class="text text-info">{{page.totalItems}}</span>-->
                        <!--&lt;!&ndash;，消费金额为：<span class="text text-info">{{restaurantSummary.totalConsumption}}</span>&ndash;&gt;-->
                        <!--&lt;!&ndash;，本月金额为：<span class="text text-info">{{restaurantSummary.monthlyConsumption}}</span>&ndash;&gt;-->
                        <!--&lt;!&ndash;，新增下单客户数：<span class="text text-info">{{restaurantSummary.aliveCustomer}}</span>&ndash;&gt;-->
                    <!--</strong>-->
                <!--</div>-->
                <!--<table wt-responsive-table class="table table-striped  table-bordered table-hover">-->
                    <!--<thead>-->
                    <!--<tr>-->
                        <!--<th><a href="" ng-click='sort("id")'> 餐馆ID</a></th>-->
                        <!--<th><a href="" ng-click='sort("name")'>店名</a></th>-->
                        <!--<th><a href="" ng-click='sort("address")'>详细地址</a></th>-->
                        <!--<th>市场</th>-->
                        <!--<th>收货人</th>-->
                        <!--<th>注册电话</th>-->
                        <!--<th>餐馆状态</th>-->
                        <!--<th>联系电话</th>-->
                        <!--<th>销售</th>-->
                        <!--<th><a href="" ng-click='sort("consumption")'>消费总金额</a></th>-->
                        <!--<th>客户类型</th>-->
                        <!--<th>客户等级</th>-->
                        <!--<th>预警标示</th>-->
                        <!--<th><a href="" ng-click='sort("lastPurchaseTime")'>未下单天数</a></th>-->
                        <!--<th>注册时间</th>-->
                        <!--&lt;!&ndash;<th>开发人员</th>&ndash;&gt;-->
                        <!--<th>操作</th>-->
                    <!--</tr>-->
                    <!--</thead>-->
                    <!--<tbody>-->
                    <!--<ng-repeat  >-->
                        <!--<tr ng-repeat="restaurant in restaurants" ng-class="{'warning':restaurant.customer.adminUser==null}" >-->

                            <!--<td >{{restaurant.id}}</td>-->
                            <!--<td>{{restaurant.name}}</td>-->
                            <!--<td>{{restaurant.address.address}}</td>-->
                            <!--<td>{{restaurant.customer.block.warehouse.name}}</td>-->
                            <!--<td>{{restaurant.receiver}}</td>-->
                            <!--<td>{{restaurant.customer.username}}</td>-->
                            <!--<td>{{restaurant.status.name}}</td>-->
                            <!--<td>-->
                                <!--<a href="" ng-click="filterTelephone(restaurant.telephone)">{{restaurant.telephone}}</a>-->
                            <!--</td>-->
                            <!--<td>-->
                                <!--<a href="" ng-click="filterAdminUser(restaurant.customer.adminUser.id)">{{restaurant.customer.adminUser.realname}}</a>-->
                            <!--</td>-->
                            <!--<td>-->
                                <!--<a class="btn btn-xs btn-info" ui-sref="oam.orderList({restaurantId:restaurant.id})">{{consumption[restaurant.id] == null ? 0 :consumption[restaurant.id]}}</a>-->
                            <!--</td>-->
                            <!--<td>{{restaurant.customer.activeType.detail}}</td>-->
                            <!--<td>{{restaurant.grade}}</td>-->
                            <!--<td>{{restaurant.warning}}</td>-->
                            <!--<td>{{restaurant.blankTime}}</td>-->
                            <!--<td>{{restaurant.createTime | date:"yyyy-MM-dd HH:mm:ss"}}</td>-->
                            <!--&lt;!&ndash;<td> <a href="" ng-click="filterAdminUser(restaurant.customer.devUser.id)">{{restaurant.customer.devUser.realname}}</a></td>&ndash;&gt;-->
                            <!--<td>-->
                                <!--&lt;!&ndash; 若是还在审核中，销售人员暂时还不是自己的餐馆， 不显示编辑和跟进按钮 &ndash;&gt;-->

                                <!--<a class="btn btn-xs btn-success" ng-if="restaurant.customer.adminUser!=null" ui-sref="crm.customerDetail({ type:'modify',restaurantId:restaurant.id })"  >编辑</a>-->
                                <!--<a class="btn btn-xs btn-primary" ng-if="restaurant.customer.adminUser!=null" >跟进</a>-->
                                <!--&lt;!&ndash;ng-if="restaurant.status == 1"&ndash;&gt;-->
                                <!--&lt;!&ndash; 未审核的餐馆 显示投放公海 及申请审核 &ndash;&gt;-->
                                <!--<a class="btn btn-xs btn-success" ng-if="restaurant.customer.adminUser!=null  &&  restaurant.status == 1" ng-click="customerToSea(restaurant.id)" >投放公海</a>-->
                                <!--<a class="btn btn-xs btn-primary" ng-if="restaurant.customer.adminUser!=null  &&  restaurant.status == 1" ng-click="reqAudit(restaurant.id)"  >申请审核</a>-->
                            <!--</td>-->
                        <!--</tr>-->
                    <!--</ng-repeat>-->
                    <!--</tbody>-->
                <!--</table>-->
            <!--</div>-->
        <!--</div>-->
    <!--</div>-->





    <!-- 商户管理 餐馆列表 -->
    <div class="row">
        <div class="col-lg-12 dataTable_wrapper table-responsive">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <strong>
                        共计商户数：<span class="text text-info">{{page.totalItems}}</span>
                        <!--，消费金额为：<span class="text text-info">{{restaurantSummary.totalConsumption}}</span>-->
                        <!--，本月金额为：<span class="text text-info">{{restaurantSummary.monthlyConsumption}}</span>-->
                        <!--，新增下单客户数：<span class="text text-info">{{restaurantSummary.aliveCustomer}}</span>-->
                    </strong>
                </div>
                <table wt-responsive-table class="table table-striped  table-bordered table-hover">
                    <thead>
                        <tr>
                            <th><a href="" ng-click='sort("id")'> 餐馆ID</a></th>
                            <th><a href="" ng-click='sort("name")'>店名</a></th>
                            <th>申请审核状态</a></th>
                            <th>注册电话</th>
                            <th>收货人</th>
                            <th>联系电话</th>
                            <th>餐馆类型</th>
                            <th>区块</th>
                            <th>餐馆状态</th>
                            <th>客户类型</th>
                            <th>维护人员</th>
                            <th>开发人员</th>
                            <th>注册时间</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody>
                    <ng-repeat  >
                        <tr ng-repeat="restaurant in restaurants" ng-class="{'warning':restaurant.customer.adminUser==null}" >

                            <td>{{restaurant.id}}</td>
                            <td>{{restaurant.name}}</td>
                            <td>{{restaurant.auditShowStatus.detail}}</td>
                            <td>{{restaurant.customer.username}}</td>
                            <td>{{restaurant.receiver}}</td>
                            <td>{{restaurant.telephone}}</td>
                            <td>{{restaurant.type.hierarchyName}}</td>
                            <td>{{restaurant.customer.block.displayName}}</td>
                            <td>{{restaurant.status.name}}</td>
                            <td>{{restaurant.activeType.detail}}</td>
                            <td>{{restaurant.customer.adminUser.realname}}</td>
                            <td>{{restaurant.customer.devUser.realname}}</td>
                            <td>{{restaurant.createTime | date:"yyyy-MM-dd HH:mm:ss"}}</td>
                            <!--<td> <a href="" ng-click="filterAdminUser(restaurant.customer.devUser.id)">{{restaurant.customer.devUser.realname}}</a></td>-->
                            <td>
                                <!-- 若是还在审核中，销售人员暂时还不是自己的餐馆， 不显示编辑和跟进按钮 -->
                                <a class="btn btn-xs btn-success" ng-if="restaurant.customer.adminUser!=null" ui-sref="crm.customerDetail({ type:'modify',restaurantId:restaurant.id })"  >编辑</a>
                                <a class="btn btn-xs btn-primary" ng-if="restaurant.customer.adminUser!=null" >跟进</a>
                                <!--ng-if="restaurant.status == 1"-->
                                <!-- 未审核的餐馆 显示投放公海 及申请审核 -->
                                <a class="btn btn-xs btn-success" ng-if="restaurant.customer.adminUser!=null  &&  restaurant.status == 1" ng-click="customerToSea(restaurant.id)" >投放公海</a>
                                <a class="btn btn-xs btn-primary" ng-if="restaurant.customer.adminUser!=null  &&  restaurant.status == 1" ng-click="reqAudit(restaurant.id)"  >申请审核</a>
                            </td>
                        </tr>
                    </ng-repeat>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- 列表底部分页 -->
    <div class="row" align="center">
        <div calss="col-lg-12">
            <pagination total-items="page.totalItems" ng-model="page.currentPage" items-per-page="page.itemsPerPage" max-size="10" class="pagination" boundary-links="true" ng-change="pageChanged()" first-text="首页" last-text="尾页" previous-text="上一页" next-text="下一页"></pagination>
        </div>
    </div>
</div>
