<div class="container-fluid">
    <div class="row">
        <div class="col-lg-12">
            <h2 class="page-header" ng-if="addPromotion">添加活动</h2>

            <h2 class="page-header" ng-if="editPromotion">编辑活动</h2>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-7">
            <form name="addPromotionForm" novalidate>

                <div class="form-group">
                    <label><font color="red">*</font>类型:</label>
                    <select class="form-control" name="promotionType" ng-model="promotion.promotionType"
                            ng-change="changePromotionType()" ng-options="o.type as o.name for o in promotionTypes"
                            validate-null>
                    </select>
                    <ng-messages for="addPromotionForm.promotionType.$error">
                        <div ng-messages-include="app/error-messages.html"></div>
                    </ng-messages>
                </div>
                <div class="form-group">
                    <label><font color="red">*</font>城市:</label>
                    <select class="form-control" name="cityId" ng-model="promotion.cityId"
                            ng-options="c.id as c.name for c in cities" validate-null>
                        <option value="">请选择-城市</option>
                    </select>
                    <ng-messages for="addPromotionForm.cityId.$error">
                        <div ng-messages-include="app/error-messages.html"></div>
                    </ng-messages>
                </div>
                <div class="form-group">
                    <label>市场:</label>
                    <select class="form-control" name="warehouseId" ng-model="promotion.warehouseId"
                            ng-options="w.id as w.name for w in warehouses">
                        <option value="">请选择-市场</option>
                    </select>
                </div>
                <div class="form-group">
                    <label><font color="red">*</font>组织:</label>
                    <select class="form-control" name="organizationId" ng-model="promotion.organizationId"
                            ng-options="o.id as o.name for o in organizations" validate-null>
                        <option value="">请选择-组织</option>
                    </select>
                    <ng-messages for="addPromotionForm.organizationId.$error">
                        <div ng-messages-include="app/error-messages.html"></div>
                    </ng-messages>
                </div>


                <div class="form-group">
                    <label>品牌:</label>
                    <ui-select ng-model="promotion.brandId" name = "brandId" theme="bootstrap" reset-search-input="true">
                        <ui-select-match allow-clear placeholder="请选择">{{$select.selected.brandName}}</ui-select-match>
                        <ui-select-choices repeat="brand.id as brand in brands | filter: $select.search">
                            <span ng-bind-html="brand.brandName | highlight: $select.search"></span>
                        </ui-select-choices>
                    </ui-select>
                </div>


                <div class="form-group">
                    <label>使用产品分类限制:(需购买指定产品后才会参与该活动)</label><br>

                    <div js-tree="treeConfig" name="useRestrictionsCategories" ng-model="categories"
                         should-apply="ignoreModelChanges()" tree="useRestrictionsTreeInstance"
                         tree-events="ready:readyCB;create_node:createNodeCB"></div>
                </div>

                <div class="form-group">
                    <label><font color="red">*</font>活动方式:</label>
                    <select class="form-control" name="promotionPattern" ng-model="promotion.promotionPattern"
                            ng-options="p.id as p.name for p in promotionPatterns" validate-null>
                    </select>
                    <ng-messages for="addPromotionForm.promotionPattern.$error">
                        <div ng-messages-include="app/error-messages.html"></div>
                    </ng-messages>
                </div>

                <div class="form-group">
                    <label><font color="red">*</font>额度(单位元):</label>
                    <input type="text" class="form-control" name="discount" ng-model="promotion.discount"
                           validate-integer validate-null>
                    <ng-messages for="addPromotionForm.discount.$error">
                        <div ng-messages-include="app/error-messages.html"></div>
                    </ng-messages>
                </div>


                <div class="form-group">
                    <label><font color="red">*</font>购买指定的sku:</label>
                    <input type="text" class="form-control" name="buySkuId" ng-model="promotion.buySkuId" validate-integer
                           validate-null>
                    <ng-messages for="addPromotionForm.buySkuId.$error">
                        <div ng-messages-include="app/error-messages.html"></div>
                    </ng-messages>
                </div>


                <div class="form-group">
                    <label><font color="red">*</font>购买指定的sku单位:</label>
                    <select class="form-control" name="buySkuUnit" ng-model="promotion.buySkuUnit"
                            ng-options="p.id as p.name for p in skuUnit" required>
                    </select>
                    <ng-messages for="addPromotionForm.buySkuUnit.$error">
                        <div ng-messages-include="app/error-messages.html"></div>
                    </ng-messages>
                </div>

                <div class="form-group">
                    <label><font color="red">*</font>购买指定的sku数量:</label>
                    <input type="text" class="form-control" name="buyQuantity" ng-model="promotion.buyQuantity"
                           validate-integer validate-null>
                    <ng-messages for="addPromotionForm.buyQuantity.$error">
                        <div ng-messages-include="app/error-messages.html"></div>
                    </ng-messages>
                </div>


                <div class="form-group">
                    <label><font color="red">*</font>赠品sku:</label>
                    <input type="text" class="form-control" name="skuId" ng-model="promotion.skuId" validate-integer
                           validate-null>
                    <ng-messages for="addPromotionForm.skuId.$error">
                        <div ng-messages-include="app/error-messages.html"></div>
                    </ng-messages>
                </div>

                <div class="form-group">
                    <label><font color="red">*</font>sku单位:</label>
                    <select class="form-control" name="skuUnit" ng-model="promotion.skuUnit"
                            ng-options="p.id as p.name for p in skuUnit" required>
                    </select>
                    <ng-messages for="addPromotionForm.skuUnit.$error">
                        <div ng-messages-include="app/error-messages.html"></div>
                    </ng-messages>
                </div>


                <div class="form-group">
                    <label><font color="red">*</font>赠品数量:</label>
                    <input type="text" class="form-control" name="quantity" ng-model="promotion.quantity"
                           validate-integer validate-null>
                    <ng-messages for="addPromotionForm.quantity.$error">
                        <div ng-messages-include="app/error-messages.html"></div>
                    </ng-messages>
                </div>

                <div class="form-group">
                    <label>限量:</label>
                    <input type="text" class="form-control" name="limited" ng-model="promotion.limitedQuantity"
                           validate-integer>
                </div>

                <div class="form-group">
                    <label><font color="red">*</font>金额限制(消费满?元可以参与活动):</label>
                    <input type="text" class="form-control" name="useRestrictionsTotalMin"
                           ng-model="promotion.useRestrictionsTotalMin" validate-integer validate-null>
                    <ng-messages for="addPromotionForm.useRestrictionsTotalMin.$error">
                        <div ng-messages-include="app/error-messages.html"></div>
                    </ng-messages>
                </div>

                <div class="form-group">
                    <label>—</label>
                    <input type="text" class="form-control" name="useRestrictionsTotalMax"
                           ng-model="promotion.useRestrictionsTotalMax" validate-integer validate-null>
                    <ng-messages for="addPromotionForm.useRestrictionsTotalMax.$error">
                        <div ng-messages-include="app/error-messages.html"></div>
                    </ng-messages>
                </div>
                <div class="form-group">
                    <label><font color="red">*</font>起始时间:</label>
                    <input type="text" name="start" class="form-control" datepicker-popup="{{format}}"
                           ng-model="promotion.start" is-open="openedStart" datepicker-options="dateOptions"
                           current-text="今日" clear-text="清除" close-text="关闭" ng-click="openStart($event)"
                           validate-null/>
                    <ng-messages for="addPromotionForm.start.$error">
                        <div ng-messages-include="app/error-messages.html"></div>
                    </ng-messages>
                </div>
                <div class="form-group">
                    <label><font color="red">*</font>结束时间:</label>
                    <input type="text" name="end" class="form-control" datepicker-popup="{{format}}"
                           ng-model="promotion.end" is-open="openedEnd" datepicker-options="dateOptions"
                           current-text="今日" clear-text="清除" close-text="关闭" ng-click="openEnd($event)" validate-null/>
                    <ng-messages for="addPromotionForm.end.$error">
                        <div ng-messages-include="app/error-messages.html"></div>
                    </ng-messages>
                </div>
                <div class="form-group">
                    <label><font color="red">*</font>描述:</label>
                    <input type="text" class="form-control" name="description" ng-model="promotion.description"
                           validate-null>
                    <ng-messages for="addPromotionForm.description.$error">
                        <div ng-messages-include="app/error-messages.html"></div>
                    </ng-messages>
                </div>
                <div class="form-group">
                    <button ng-if="!sendPromotion" type="submit" class="btn btn-primary" ng-click="createPromotion()"
                            ng-disabled="tableInvalid()">&nbsp;&nbsp;提&nbsp;&nbsp;交&nbsp;&nbsp;</button>
                    <button type="button" back class="btn btn-info">&nbsp;&nbsp;取&nbsp;&nbsp;消&nbsp;&nbsp;</button>
                </div>

            </form>

        </div>
    </div>

</div>